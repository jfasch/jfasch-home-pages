
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="crosstool-ng - built Raspberry Pi Cross Toolchain" name="description" />
<meta content="cross development, raspberry pi, linux, crosstool-ng, gcc, c++" name="keywords" />

    <title>Building A Cross Toolchain For The Raspberry Pi, Using crosstool-ng &#8212; Jörg Faschingbauer</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/jf-alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
    <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <link rel="canonical" href="https://www.faschingbauer.me/blog/2022/09/cross-raspi.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../blog/atom.xml"
  title="Jörg Faschingbauer"
/>
 
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Linux und Open Source</p>







<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Schulungen</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../trainings/index.html">Kursangebot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trainings/material/index.html">Unterlagen &amp; Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trainings/org.html">Organisatorisches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trainings/codex.html">Datenschutz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trainings/log/index.html">Bisher Gehaltene</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about/myself/index.html">Über Mich</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about/site/index.html">About This Site</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Blog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Posts</a></li>
</ul>

  
<h2>
   <i class="fa fa-calendar"></i>
  2022-09-23 
</h2>

<ul>
   
<li id="author">
  <span
    ><i class="fa-fw fa fa-user"></i></span
  >
   
  <a href="../../author/jorg-faschingbauer.html">Jörg Faschingbauer</a>  
</li>
 
<li id="location">
  <span
    ><i class="fa-fw fa fa-location-arrow"></i></span
  >
   
  <a href="../../location/graz-austria.html">Graz, Austria</a>  
</li>
 
<li id="language">
  <span
    ><i class="fa-fw fa fa-language"></i></span
  >
   
  <a href="../../language/en.html">en</a>  
</li>
 
<li id="category">
  <span
    ><i class="fa-fw fa fa-folder-open"></i></span
  >
   
  <a href="../../category/embedded.html">embedded</a>,   
  <a href="../../category/linux.html">linux</a>,   
  <a href="../../category/raspberry.html">raspberry</a>  
</li>
  
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
             <section id="building-a-cross-toolchain-for-the-raspberry-pi-using-crosstool-ng">
<h1>Building A Cross Toolchain For The Raspberry Pi, Using <code class="docutils literal notranslate"><span class="pre">crosstool-ng</span></code><a class="headerlink" href="#building-a-cross-toolchain-for-the-raspberry-pi-using-crosstool-ng" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#why-this-article-why-not-use-a-prebuilt-toolchain" id="id10">Why This Article? Why Not Use A Prebuilt Toolchain?</a></p></li>
<li><p><a class="reference internal" href="#installing-crosstool-ng" id="id11">Installing <code class="docutils literal notranslate"><span class="pre">crosstool-ng</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites" id="id12">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#download-build-install" id="id13">Download, Build, Install</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configure-toolchain-build" id="id14">Configure Toolchain Build</a></p>
<ul>
<li><p><a class="reference internal" href="#base-configuration-for-the-raspberry" id="id15">Base Configuration For The Raspberry</a></p></li>
<li><p><a class="reference internal" href="#important-glibc-version" id="id16">Important: <code class="docutils literal notranslate"><span class="pre">glibc</span></code> Version</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#toolchain-build-install" id="id17">Toolchain Build/Install</a></p></li>
<li><p><a class="reference internal" href="#test" id="id18">Test</a></p>
<ul>
<li><p><a class="reference internal" href="#simplest-c-stdio-h" id="id19">Simplest: C, <code class="docutils literal notranslate"><span class="pre">&lt;stdio.h&gt;</span></code></a></p></li>
<li><p><a class="reference internal" href="#c-iostream" id="id20">C++, <code class="docutils literal notranslate"><span class="pre">&lt;iostream&gt;</span></code></a></p></li>
<li><p><a class="reference internal" href="#c-thread" id="id21">C++, <code class="docutils literal notranslate"><span class="pre">&lt;thread&gt;</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#packaging-distributing-the-toolchain" id="id22">Packaging/Distributing The Toolchain</a></p></li>
<li><p><a class="reference internal" href="#afterword" id="id23">Afterword</a></p></li>
</ul>
</div>
<section id="why-this-article-why-not-use-a-prebuilt-toolchain">
<h2><a class="toc-backref" href="#id10">Why This Article? Why Not Use A Prebuilt Toolchain?</a><a class="headerlink" href="#why-this-article-why-not-use-a-prebuilt-toolchain" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>There <a class="reference external" href="https://github.com/raspberrypi/tools">used to be</a> a
toolchain for the Raspberry Pi, made by the <a class="reference external" href="https://www.raspberrypi.com/software/">Raspberry Pi OS</a> creators. Sadly, this
repository has been dead since years.</p></li>
<li><p>One popular toolchain, <a class="reference external" href="https://snapshots.linaro.org/gnu-toolchain/">Linaro</a>, is widely
recommended for the Raspberry. It does not work for C++ though - its
<code class="docutils literal notranslate"><span class="pre">libstdc++</span></code> has an unsatisfied version dependency on
<code class="docutils literal notranslate"><span class="pre">libpthread</span></code>.</p></li>
<li><p>A number of other Raspberry toolchains exist out there, but I either
didn’t get them to work at all (see the <code class="docutils literal notranslate"><span class="pre">glibc</span></code> <a class="reference internal" href="#glibc-version"><span class="std std-ref">version
dependency</span></a>), or didn’t get them to work for C++.</p></li>
<li><p>Let alone the bullshitting on the Internet where one asks,</p>
<div class="line-block">
<div class="line"><em>Where can I find a cross toolchain for the Pi?</em></div>
</div>
<p>Responses …</p>
<div class="line-block">
<div class="line"><em>This does not work. Build on the Pi locally.</em></div>
</div>
<p>… and …</p>
<div class="line-block">
<div class="line"><em>Use distcc if one Pi is not enough.</em></div>
</div>
</li>
</ul>
<p>Prebuilt toolchains may work for C, but I failed to find one that
works for C++. The amount of work that I invested in finding one was,
in my opinion, totally wasted. Building a toolchain yourself is not at
all hard, provided that you bring basic Linux understanding (which you
should if you program for it).</p>
<p>In my opinion (feedback <a class="reference internal" href="../../../about/myself/contact.html"><span class="doc">welcome</span></a>), this
article describes the most close-to-correct way to build a toolchain
for a target that does not come with a toolchain. Although I describe
the situation for the Raspberry (because that was my primary
intention), it will sure work for <em>any</em> target.</p>
</section>
<section id="installing-crosstool-ng">
<h2><a class="toc-backref" href="#id11">Installing <code class="docutils literal notranslate"><span class="pre">crosstool-ng</span></code></a><a class="headerlink" href="#installing-crosstool-ng" title="Permalink to this headline">¶</a></h2>
<p>Below is a writeup of how I installed <code class="docutils literal notranslate"><span class="pre">crosstool-ng</span></code> (running
Fedora, I chose to install from a released tarball) . Please read
through their <a class="reference external" href="https://crosstool-ng.github.io/docs/install/">installation documentation</a> for your particular
situation.</p>
<section id="prerequisites">
<h3><a class="toc-backref" href="#id12">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">crosstool-ng</span></code> requires one to install a number of packages
first. Thankfully, they do thorough testing in Docker, and the list of
dependencies can be taken from the Docker file for your OS (see <a class="reference external" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/testing/docker">here</a>).</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Dependencies for Fedora</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">root@host # </span>dnf install autoconf gperf bison file flex texinfo help2man gcc-c++ libtool make patch <span class="se">\</span>
    ncurses-devel python3-devel perl-Thread-Queue bzip2 git wget which xz unzip rsync diffutils <span class="se">\</span>
    meson ninja-build
</pre></div>
</div>
</div>
</section>
<section id="download-build-install">
<h3><a class="toc-backref" href="#id13">Download, Build, Install</a><a class="headerlink" href="#download-build-install" title="Permalink to this headline">¶</a></h3>
<p>I chose to install from a release tarball (<a class="reference external" href="https://crosstool-ng.github.io/download/">here</a>; current version as of
this writing is <code class="docutils literal notranslate"><span class="pre">1.25.0</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host$ </span>wget http://crosstool-ng.org/download/crosstool-ng/crosstool-ng-1.25.0.tar.xz
<span class="gp">me@host$ </span>tar xf crosstool-ng-1.25.0.tar.xz
<span class="gp">me@host$ </span><span class="nb">cd</span> crosstool-ng-1.25.0/
<span class="gp">me@host$ </span>./configure --prefix<span class="o">=</span>/home/jfasch/cross
<span class="gp">me@host$ </span>make
<span class="gp">me@host$ </span>make install
</pre></div>
</div>
<p>Add <code class="docutils literal notranslate"><span class="pre">ct-ng</span></code> to <code class="docutils literal notranslate"><span class="pre">PATH</span></code>,</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">You may want to add this to <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code></span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>me@host$ <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$HOME</span>/cross/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
</div>
<p>Test if all is well,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host$ </span>ct-ng <span class="nb">help</span>
<span class="go">This is crosstool-NG version 1.25.0</span>

<span class="go">Copyright (C) 2008  Yann E. MORIN &lt;yann.morin.1998@free.fr&gt;</span>
<span class="go">This is free software; see the source for copying conditions.</span>
<span class="go">There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A</span>
<span class="go">PARTICULAR PURPOSE.</span>
<span class="go">...</span>
</pre></div>
</div>
</section>
</section>
<section id="configure-toolchain-build">
<h2><a class="toc-backref" href="#id14">Configure Toolchain Build</a><a class="headerlink" href="#configure-toolchain-build" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ct-ng</span></code> toolchain build configuration works a lot like the Linux
kernel’s configuration system (a little less elaborate though). There
are a number of base configurations to choose from (we need a
Raspberry config), and, having chosen one, you can tune it to your
needs.</p>
<section id="base-configuration-for-the-raspberry">
<h3><a class="toc-backref" href="#id15">Base Configuration For The Raspberry</a><a class="headerlink" href="#base-configuration-for-the-raspberry" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host$ </span>ct-ng list-samples<span class="p">|</span>grep rpi
<span class="go">[G...]   aarch64-rpi3-linux-gnu</span>
<span class="go">[G...]   aarch64-rpi4-linux-gnu</span>
<span class="go">[G...]   armv7-rpi2-linux-gnueabihf</span>
<span class="go">[G...]   armv8-rpi3-linux-gnueabihf</span>
<span class="go">[G...]   armv8-rpi4-linux-gnueabihf</span>
</pre></div>
</div>
<p>Mine is a Pi 4, still running the (still default) 32 bit version, so I
create a <code class="docutils literal notranslate"><span class="pre">.config</span></code> file for that,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>ct-ng armv8-rpi4-linux-gnueabihf
<span class="gp">me@host $ </span>ls -l .config
<span class="go">-rw-r--r--. 1 jfasch jfasch 23179 Sep 23 08:18 .config</span>
</pre></div>
</div>
</section>
<section id="important-glibc-version">
<span id="glibc-version"></span><h3><a class="toc-backref" href="#id16">Important: <code class="docutils literal notranslate"><span class="pre">glibc</span></code> Version</a><a class="headerlink" href="#important-glibc-version" title="Permalink to this headline">¶</a></h3>
<p>Executables built by your toolchain won’t work if the toolchain links
against a C library whose version is higher than what is present on
the target. Continuing with the above default configuration, and just
saying <code class="docutils literal notranslate"><span class="pre">ct-ng</span> <span class="pre">build</span></code> will likely result in an error
<a class="footnote-reference brackets" href="#glibc-default-version" id="id2">3</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@target $ </span>./a.out
<span class="go">./a.out: /lib/arm-linux-gnueabihf/libc.so.6: version `GLIBC_2.34&#39; not found (required by ./a.out)</span>
</pre></div>
</div>
<p>Background is that <code class="docutils literal notranslate"><span class="pre">glibc</span></code> employs <a class="reference external" href="https://refspecs.linuxfoundation.org/LSB_3.0.0/LSB-PDA/LSB-PDA.junk/symversion.html">ELF symbol versioning</a>
a lot. Key point is that an executable which links against version,
say, <cite>2.34</cite> (which is the <code class="docutils literal notranslate"><span class="pre">ct-ng</span></code> default), will require the symbol
<code class="docutils literal notranslate"><span class="pre">GLIBC_2.34</span></code> in the C library, and fail to load if the target
<code class="docutils literal notranslate"><span class="pre">glibc</span></code> version is, say, <code class="docutils literal notranslate"><span class="pre">2.28</span></code> <a class="footnote-reference brackets" href="#my-situation" id="id3">1</a>. That version
obviously cannot have <code class="docutils literal notranslate"><span class="pre">GLIBC_2.34</span></code>, so the executable cannot load.</p>
<p>Find out location of <code class="docutils literal notranslate"><span class="pre">glibc</span></code>,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@target $ </span>ldd /usr/bin/ls
<span class="go">        ...</span>
<span class="go">        libc.so.6 =&gt; /lib/arm-linux-gnueabihf/libc.so.6 (0xb6e06000)</span>
<span class="go">        ...</span>
</pre></div>
</div>
<p>Simply <em>invoke</em> (sic!) the library,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@target $ </span>/lib/arm-linux-gnueabihf/libc.so.6
<span class="go">GNU C Library (Debian GLIBC 2.28-10+rpt2+rpi1+deb10u1) stable release version 2.28.</span>
<span class="go">...</span>
</pre></div>
</div>
<p>So, it’s <code class="docutils literal notranslate"><span class="pre">2.28</span></code>. Tune configuration,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>ct-ng menuconfig
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">C-library</span> <span class="pre">-&gt;</span> <span class="pre">Version</span> <span class="pre">of</span> <span class="pre">glibc</span></code>, choose <code class="docutils literal notranslate"><span class="pre">2.28</span></code>.</p>
<a class="reference internal image-reference" href="../../../_images/glibc-version.png"><img alt="../../../_images/glibc-version.png" src="../../../_images/glibc-version.png" style="width: 477.0px; height: 255.5px;" /></a>
<p>Minor quirk: version <code class="docutils literal notranslate"><span class="pre">2.28</span></code> does not build without warnings, so one
has to disable <code class="docutils literal notranslate"><span class="pre">-Werror</span></code> during its build,</p>
<a class="reference internal image-reference" href="../../../_images/werror.png"><img alt="../../../_images/werror.png" src="../../../_images/werror.png" style="width: 477.0px; height: 255.5px;" /></a>
</section>
</section>
<section id="toolchain-build-install">
<h2><a class="toc-backref" href="#id17">Toolchain Build/Install</a><a class="headerlink" href="#toolchain-build-install" title="Permalink to this headline">¶</a></h2>
<p>This is as simple as saying,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>ct-ng build
</pre></div>
</div>
<p>By default <a class="footnote-reference brackets" href="#ct-prefix" id="id4">2</a>, the toolchain is installed in
<code class="docutils literal notranslate"><span class="pre">$HOME/x-tools/armv8-rpi4-linux-gnueabihf/</span></code> (you may want to add
<code class="docutils literal notranslate"><span class="pre">$HOME/x-tools/armv8-rpi4-linux-gnueabihf/bin/</span></code> to <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>).</p>
</section>
<section id="test">
<h2><a class="toc-backref" href="#id18">Test</a><a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h2>
<p>I tested the toolchain from a number of viewpoints that I describe
below.</p>
<section id="simplest-c-stdio-h">
<h3><a class="toc-backref" href="#id19">Simplest: C, <code class="docutils literal notranslate"><span class="pre">&lt;stdio.h&gt;</span></code></a><a class="headerlink" href="#simplest-c-stdio-h" title="Permalink to this headline">¶</a></h3>
<p>Check for availability of <code class="docutils literal notranslate"><span class="pre">libc</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/930da294b589e3c0ee18e29e9212dc93/c-stdio.c"><code class="xref download docutils literal notranslate"><span class="pre">c-stdio.c</span></code></a></span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello World</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>~/x-tools/armv8-rpi4-linux-gnueabihf/bin/armv8-rpi4-linux-gnueabihf-gcc c-stdio.c
<span class="gp">me@host $ </span>scp a.out me@target:
<span class="gp">me@host $ </span>ssh me@target ./a.out
<span class="go">Hello World</span>
</pre></div>
</div>
</section>
<section id="c-iostream">
<h3><a class="toc-backref" href="#id20">C++, <code class="docutils literal notranslate"><span class="pre">&lt;iostream&gt;</span></code></a><a class="headerlink" href="#c-iostream" title="Permalink to this headline">¶</a></h3>
<p>Check for availability of <code class="docutils literal notranslate"><span class="pre">libstdc++</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/1f44756998952fcb268db788f7cf730b/c%2B%2B-iostream.cpp"><code class="xref download docutils literal notranslate"><span class="pre">c++-iostream.cpp</span></code></a></span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Hello World&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>~/x-tools/armv8-rpi4-linux-gnueabihf/bin/armv8-rpi4-linux-gnueabihf-g++ c++-iostream.cpp
<span class="gp">me@host $ </span>scp a.out me@target:
<span class="gp">me@host $ </span>ssh me@target ./a.out
<span class="go">Hello World</span>
</pre></div>
</div>
</section>
<section id="c-thread">
<h3><a class="toc-backref" href="#id21">C++, <code class="docutils literal notranslate"><span class="pre">&lt;thread&gt;</span></code></a><a class="headerlink" href="#c-thread" title="Permalink to this headline">¶</a></h3>
<p>Check for availability of <code class="docutils literal notranslate"><span class="pre">libpthread</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/59cbba0b5d6de2183a7a48be92ed635e/c%2B%2B-thread.cpp"><code class="xref download docutils literal notranslate"><span class="pre">c++-thread.cpp</span></code></a></span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;thread&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="w"> </span><span class="n">t</span><span class="p">([](){</span><span class="w"></span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Hello Thread&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bye&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">me@host $ </span>~/x-tools/armv8-rpi4-linux-gnueabihf/bin/armv8-rpi4-linux-gnueabihf-g++ -pthread c++-thread.cpp
<span class="gp">me@host $ </span>scp a.out me@target:
<span class="gp">me@host $ </span>ssh me@target ./a.out
<span class="go">Hello Thread</span>
<span class="go">Bye</span>
</pre></div>
</div>
</section>
</section>
<section id="packaging-distributing-the-toolchain">
<h2><a class="toc-backref" href="#id22">Packaging/Distributing The Toolchain</a><a class="headerlink" href="#packaging-distributing-the-toolchain" title="Permalink to this headline">¶</a></h2>
<p>The toolchain is fully relocatable. Although
<code class="docutils literal notranslate"><span class="pre">$HOME/x-tools/armv8-rpi4-linux-gnueabihf/</span></code> contains the cross
toolchain <em>together</em> with the <a class="reference internal" href="../../../trainings/material/soup/linux/toolchain/cross/basics.html"><span class="doc">sysroot</span></a>, even if you
move it around it will remain self-contained.</p>
<p>Pack it into an archive,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tar -C ~/x-tools -J -c -f raspberry-pi-toolchain.tar.xz armv8-rpi4-linux-gnueabihf/
</pre></div>
</div>
<p>And share it with your colleagues.</p>
</section>
<section id="afterword">
<h2><a class="toc-backref" href="#id23">Afterword</a><a class="headerlink" href="#afterword" title="Permalink to this headline">¶</a></h2>
<p>I hope I could help you with this article. Share it if I could, or, if
I couldn’t, feel free to send me an <a class="reference internal" href="../../../about/myself/contact.html"><span class="doc">email</span></a> explaining why.</p>
<p>Either way: cross development is not easy, given the huge number of
dependencies between target libraries. This is a rather complex and
fragile thing, and there are sure better ways to do cross development
than the one that I describe here. Ideally, a target vendor (in our
case, the guys who create <a class="reference external" href="https://www.raspberrypi.com/software/">Raspberry Pi OS</a>) would release an SDK that
developers could install, and that contained <em>all</em> that is necessary
to do cross development. This would be the toolchain and associated
basic runtime libraries (described here), and the entire <em>sysroot</em> of
the target.</p>
<p>Creating such an SDK is the job of higher level tools like <a class="reference external" href="https://www.yoctoproject.org/">Yocto</a> or <a class="reference external" href="https://buildroot.org/">Buildroot</a> - but this is another story.</p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="my-situation"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p>That describes the situation that I encountered;
yours might be a little different.</p>
</dd>
<dt class="label" id="ct-prefix"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>You change the installation prefix by setting the
<code class="docutils literal notranslate"><span class="pre">CT_PREFIX</span></code> environment variable prior to building,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">CT_PREFIX</span><span class="o">=</span>/some/other/location ct-ng build
</pre></div>
</div>
</dd>
<dt class="label" id="glibc-default-version"><span class="brackets"><a class="fn-backref" href="#id2">3</a></span></dt>
<dd><p>As of this writing, <code class="docutils literal notranslate"><span class="pre">ct-ng</span></code> chooses the
GNU C Library version <code class="docutils literal notranslate"><span class="pre">2.34</span></code>. Your
situation might be different, the
principle remains the same.</p>
</dd>
</dl>
</section>
</section>

<div class="section">
     
<div class="section">
  <span style="float: left">
     
    <a href="../../2021/09/xps13-shim-mok-brick/index.html">
      <i class="fa fa-arrow-circle-left"></i> How to Brick a €1399 Dell XPS 13
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
    
  </span>
</div>
  
</div>

          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2019-2022 (GPLv3), Jörg Faschingbauer.
      
      |
      <a href="../../../_sources/blog/2022/09/cross-raspi.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>