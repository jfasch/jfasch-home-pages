<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Jörg Faschingbauer - Posted in 2020</title>
  <id>https://www.faschingbauer.me/blog/2020/atom.xml</id>
  <updated>2020-03-22T00:00:00Z</updated>
  <link href="https://www.faschingbauer.me" />
  <link href="https://www.faschingbauer.me/blog/2020/atom.xml" rel="self" />
  <generator uri="https://ablog.readthedocs.org" version="0.10.3">ABlog</generator>
  <entry xml:base="https://www.faschingbauer.me/blog/2020/atom.xml">
    <title type="text">Using Microsoft Teams on Linux</title>
    <id>https://www.faschingbauer.me/blog/2020/03/ms-teams-on-linux.html</id>
    <updated>2020-03-22T00:00:00Z</updated>
    <published>2020-03-22T00:00:00Z</published>
    <link href="https://www.faschingbauer.me/blog/2020/03/ms-teams-on-linux.html" />
    <author>
      <name>Jörg Faschingbauer</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;using-microsoft-teams-on-linux&quot;&gt;

&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Contents&lt;/p&gt;
&lt;div class=&quot;contents local topic&quot; id=&quot;contents&quot;&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#screen-sharing-x11-revival&quot; id=&quot;id5&quot;&gt;Screen Sharing: X11 Revival&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#rpm-package-meh&quot; id=&quot;id6&quot;&gt;RPM Package (Meh!)&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#annoyance-1-keeps-running-in-background&quot; id=&quot;id7&quot;&gt;Annoyance #1: Keeps Running in Background&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#annoyance-2-re-registers-itself-for-autostart&quot; id=&quot;id8&quot;&gt;Annoyance #2: (Re)Registers Itself For Autostart&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#run-in-browser-my-recommendation&quot; id=&quot;id9&quot;&gt;Run In Browser (My Recommendation)&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;I frequently run &lt;a class=&quot;reference internal&quot; href=&quot;../trainings/index.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;trainings&lt;/span&gt;&lt;/a&gt; for
companies. These trainings use to take place physically - I book hotel
and train for the duration of the training, meet people face to face,
have fun, and then travel home again.&lt;/p&gt;
&lt;p&gt;Things have changed: it’s the &lt;em&gt;Age Of The Corona Virus&lt;/em&gt;, everybody’s
working from home &lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#homeoffice-should-be-default&quot; id=&quot;id1&quot;&gt;1&lt;/a&gt;, and the demand for
video conferencing solutions has grown dramatically
&lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#microsoft-conspiracy-theory&quot; id=&quot;id2&quot;&gt;2&lt;/a&gt;. A customer, having ordered a training
end of March, has asked me if we could do the training online - using
Microsoft Teams &lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#teamviewer-experience&quot; id=&quot;id3&quot;&gt;4&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I spent a couple of hours to work out if and how that is done on
Linux, and to test all the details; this is what I want to share with
you in this post. It is sure not a definitive guide as I am not a
Microsoft expert &lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#driver-dont-tell-anybody&quot; id=&quot;id4&quot;&gt;3&lt;/a&gt;, and things might have
changed as you read this. Please &lt;a class=&quot;reference internal&quot; href=&quot;../about/myself/contact.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;inform me&lt;/span&gt;&lt;/a&gt; if you have news.&lt;/p&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;admonition-title&quot;&gt;Note&lt;/p&gt;
&lt;p&gt;What follows might not sound like I am a friend of Microsoft. (I
admit I’m not.) For a reason though - &lt;em&gt;“Cloud everywhere”&lt;/em&gt; has
replaced &lt;em&gt;“Windows everywhere”&lt;/em&gt; - Linux users see more openness
throughout the past decade. I appreciate that.&lt;/p&gt;
&lt;img alt=&quot;../_images/cloud-linux.jpg&quot; src=&quot;../_images/cloud-linux.jpg&quot; style=&quot;width: 240.0px; height: 164.1px;&quot; /&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;screen-sharing-x11-revival&quot;&gt;
&lt;span id=&quot;desktop-sharing-x11-revival&quot;&gt;&lt;/span&gt;&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id5&quot;&gt;Screen Sharing: X11 Revival&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;First off: none of the methods described in the remainder works with
&lt;a class=&quot;reference external&quot; href=&quot;https://wayland.freedesktop.org/&quot;&gt;Wayland&lt;/a&gt;. Wayland (and its
reference implementation, Weston) is intended to replace the X11
display protocol which has shown its age. Major distributions have
invested large amounts of work to make the switch, to the point that
Wayland runs really smooth nowadays. An X11 compatibility layer is
there to keep X11 applications happy.&lt;/p&gt;
&lt;p&gt;Smooth - except for cornercases like X11 programs which want to share
the desktop, apparently. For Teams, this means:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;The RPM native desktop app crashes hard when you hover over the
“share screen” field.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The browser app, from the sharer’s point of view, appears to share
like you tell it to. Meeting participants only see the mouse on a
black screen, no matter what the sharer does.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, here’s how to make your login screen start an X11 session, rather
than a Wayland session.&lt;/p&gt;
&lt;p&gt;In &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;/etc/gdm/custom.conf&lt;/span&gt;&lt;/code&gt;, a .ini style configuration file, you see
the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;[daemon]&lt;/span&gt;&lt;/code&gt; section,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;[daemon]&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; Uncomment the line below to force the login screen to use Xorg
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;WaylandEnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DefaultSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;gnome-xorg.desktop
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Switch to X11,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;[daemon]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;WaylandEnable=false&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;DefaultSession=gnome-xorg.desktop&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Log out (i.e. terminate the current Wayland session), log back in
(i.e. start an X11 session), done.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;rpm-package-meh&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id6&quot;&gt;RPM Package (Meh!)&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;(I’m on Fedora; there’s also a &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;.deb&lt;/span&gt;&lt;/code&gt; available.)&lt;/p&gt;
&lt;p&gt;Download the RPM from &lt;a class=&quot;reference external&quot; href=&quot;https://teams.microsoft.com/downloads&quot;&gt;here&lt;/a&gt;; it’ll be available as
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;~/Downloads/teams-1.3.00.5153-1.x86_64.rpm&lt;/span&gt;&lt;/code&gt; (your version might
differ) if you used a browser for the download. If you used &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;wget&lt;/span&gt;&lt;/code&gt;
then you know better where the file is.&lt;/p&gt;
&lt;p&gt;Install it as root,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; sudo rpm -ivh ~/Downloads/teams-1.3.00.5153-1.x86_64.rpm
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Start it,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; teams
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;That was easy. Login with your Microsoft account, and figure out how
to use it (this is not the point of this post).&lt;/p&gt;
&lt;div class=&quot;section&quot; id=&quot;annoyance-1-keeps-running-in-background&quot;&gt;
&lt;h3&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id7&quot;&gt;Annoyance #1: Keeps Running in Background&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Call me old fashioned, but I like programs to quit when I tell them
to - especially when I know they use my microphone and camera. Teams
doesn’t; it keeps running in the background,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; ps -efl&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;grep teams
&lt;span class=&quot;go&quot;&gt;0 S jfasch     61762    1670  1  80   0 - 947213 -     17:04 ?        00:00:22 /usr/share/teams/teams&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;0 S jfasch     61764   61762  0  80   0 - 98775 -      17:04 ?        00:00:00 /usr/share/teams/teams --type=zygote --no-sandbox&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;0 S jfasch     61800   61762  0  80   0 - 239615 -     17:04 ?        00:00:13 /usr/share/teams/teams --type=gpu-process --enable-features=SharedArrayBuffer --disable-features=SpareRendererForSitePerProcess --gpu-preferences=KAAAAAAAAACAAABAAQAAAAAAAAAAAGAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA --service-request-channel-token=4327801531638606376&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;1 S jfasch     61825   61764  0  80   0 - 420846 -     17:04 ?        00:00:00 /usr/share/teams/teams --type=renderer --autoplay-policy=no-user-gesture-required --enable-features=SharedArrayBuffer --disable-features=SpareRendererForSitePerProcess --service-pipe-token=12993561460135093079 --lang=en-US --app-path=/usr/share/teams/resources/app.asar --user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) MicrosoftTeams-Preview/1.3.00.5153 Chrome/69.0.3497.128 Electron/4.2.12 Safari/537.36 --node-integration=false --webview-tag=false --no-sandbox --preload=/usr/share/teams/resources/app.asar/lib/renderer/notifications/preload_notifications.js --disable-remote-module --background-color=#fff --electron-shared-settings=eyJjci5jb21wYW55IjoiRWxlY3Ryb24iLCJjci5kdW1wcyI6IiIsImNyLmVuYWJsZWQiOmZhbHNlLCJjci5wcm9kdWN0IjoiRWxlY3Ryb24iLCJjci5zZXNzaW9uIjoiIiwiY3IudXJsIjoiIiwiY3IudmVyc2lvbiI6InY0LjIuMTIifQ== --num-raster-threads=4 --enable-main-frame-before-activation --service-request-channel-token=12993561460135093079 --renderer-client-id=7 --shared-files=v8_context_snapshot_data:100,v8_natives_data:101 --msteams-process-type=notificationsManager&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;1 S jfasch     61973   61764  2  80   0 - 790018 -     17:04 ?        00:00:45 /usr/share/teams/teams --type=renderer --autoplay-policy=no-user-gesture-required --enable-features=SharedArrayBuffer --disable-features=SpareRendererForSitePerProcess --service-pipe-token=432557619363765409 --lang=en-US --app-path=/usr/share/teams/resources/app.asar --user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) MicrosoftTeams-Preview/1.3.00.5153 Chrome/69.0.3497.128 Electron/4.2.12 Safari/537.36 --node-integration=false --webview-tag=true --no-sandbox --preload=/usr/share/teams/resources/app.asar/lib/renderer/preload.js --disable-remote-module --background-color=#fff --electron-shared-settings=eyJjci5jb21wYW55IjoiRWxlY3Ryb24iLCJjci5kdW1wcyI6IiIsImNyLmVuYWJsZWQiOmZhbHNlLCJjci5wcm9kdWN0IjoiRWxlY3Ryb24iLCJjci5zZXNzaW9uIjoiIiwiY3IudXJsIjoiIiwiY3IudmVyc2lvbiI6InY0LjIuMTIifQ== --num-raster-threads=4 --enable-main-frame-before-activation --service-request-channel-token=432557619363765409 --renderer-client-id=16 --shared-files=v8_context_snapshot_data:100,v8_natives_data:101 --msteams-process-type=mainWindow&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;1 S jfasch     62033   61764  5  80   0 - 1259666 -    17:04 ?        00:01:26 /usr/share/teams/teams --type=renderer --autoplay-policy=no-user-gesture-required --enable-features=SharedArrayBuffer --disable-features=SpareRendererForSitePerProcess --service-pipe-token=5585537623314398260 --lang=en-US --app-path=/usr/share/teams/resources/app.asar --user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) MicrosoftTeams-Preview/1.3.00.5153 Chrome/69.0.3497.128 Electron/4.2.12 Safari/537.36 --node-integration=false --webview-tag=false --no-sandbox --preload=/usr/share/teams/resources/app.asar/lib/pluginhost/preload.js --disable-remote-module --background-color=#fff --electron-shared-settings=eyJjci5jb21wYW55IjoiRWxlY3Ryb24iLCJjci5kdW1wcyI6IiIsImNyLmVuYWJsZWQiOmZhbHNlLCJjci5wcm9kdWN0IjoiRWxlY3Ryb24iLCJjci5zZXNzaW9uIjoiIiwiY3IudXJsIjoiIiwiY3IudmVyc2lvbiI6InY0LjIuMTIifQ== --num-raster-threads=4 --enable-main-frame-before-activation --service-request-channel-token=5585537623314398260 --renderer-client-id=20 --shared-files=v8_context_snapshot_data:100,v8_natives_data:101 --msteams-process-type=pluginHost&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;When I look at the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;SZ&lt;/span&gt;&lt;/code&gt; column of the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;ps&lt;/span&gt;&lt;/code&gt; output, that
&lt;a class=&quot;reference internal&quot; href=&quot;2012/04/Why-ps-sucks.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;makes me wish&lt;/span&gt;&lt;/a&gt; it would really
stop. It consumes insane amounts of memory doing nothing.&lt;/p&gt;
&lt;p&gt;Make it so,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; killall teams
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Check,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; ps -efl&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;grep teams
&lt;span class=&quot;go&quot;&gt;0 R jfasch     63500    1670 47  80   0 - 298385 -     17:41 ?        00:00:00 /usr/share/teams/teams&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;0 S jfasch     63502   63500  1  80   0 - 98775 -      17:41 ?        00:00:00 /usr/share/teams/teams --type=zygote --no-sandbox&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Blood pressure rising,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; killall -9 teams
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;admonition-title&quot;&gt;Note&lt;/p&gt;
&lt;p&gt;If I don’t wipe it entirely with &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;killall&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;-9&lt;/span&gt;&lt;/code&gt;, it comes back from
time to time and says, “Please log in with your Microsoft
account”. &lt;em&gt;Cool feature, guys!&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;annoyance-2-re-registers-itself-for-autostart&quot;&gt;
&lt;h3&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id8&quot;&gt;Annoyance #2: (Re)Registers Itself For Autostart&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Logout, and back in. Teams pops up right into my face. Maybe that’s
the desired behavior in the office world where everyone’s in a meeting
at any given point in time. I live in a different world though: when I
want something to pop into my face in the morning (I rarely do), I
configure it so.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rm ~/.config/autostart/teams.desktop
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;True, I could have edited the offending line of that file,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;X-GNOME-Autostart-enabled=true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;But no.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; sudo rpm -e teams
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;run-in-browser-my-recommendation&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id9&quot;&gt;Run In Browser (My Recommendation)&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;It turns out that Teams can run in the browser (thanks to &lt;a class=&quot;reference external&quot; href=&quot;https://webassembly.org/&quot;&gt;WebAssembly&lt;/a&gt;?). Really cool:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;I need not install a closed-source program (and let it access all my
files)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I need not blow it out of the water when my blood pressure rises&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It simply goes away when I close the browser tab&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Its security is that of the browser (if that’s an argument)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Simply point your browser to
&lt;a class=&quot;reference external&quot; href=&quot;https://teams.microsoft.com/&quot;&gt;https://teams.microsoft.com/&lt;/a&gt;. That’s it.&lt;/p&gt;
&lt;p&gt;Well, no, it’s actually not so simple.&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;It does not work with Firefox 74.0 (shipped with Fedora 31, as of
2020-03-22). The error message says something like “DOM storage not
enabled”. I checked, DOM storage &lt;em&gt;is&lt;/em&gt; enabled; this is where I gave
up.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It works in Chromium “Version 80.0.3987.132 (Developer Build) Fedora
Project (64-bit)” (as it says) (shipped with Fedora 31, as of
2020-03-22)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Take care to run &lt;a class=&quot;reference internal&quot; href=&quot;2020/03/ms-teams-on-linux.html#desktop-sharing-x11-revival&quot;&gt;&lt;span class=&quot;std std-ref&quot;&gt;X11 as explained above&lt;/span&gt;&lt;/a&gt; (to be able to share the desktop)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p class=&quot;rubric&quot;&gt;Footnotes&lt;/p&gt;
&lt;dl class=&quot;footnote brackets&quot;&gt;
&lt;dt class=&quot;label&quot; id=&quot;homeoffice-should-be-default&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id1&quot;&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Once the plague comes to an end, I
hope we remember that The Internet
hasn’t originally been invented for
the purpose of gaming, streaming,
and pornwatching - and work from
home more.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt class=&quot;label&quot; id=&quot;microsoft-conspiracy-theory&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id2&quot;&gt;2&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;It’s also the age of conspiracy
theories. “That’s &lt;a class=&quot;reference external&quot; href=&quot;https://www.zeit.de/wissen/gesundheit/2012-01/tamiflu-cochrane-wirksamkeit&quot;&gt;Roche again&lt;/a&gt;!”
I take the opportunity to add
another one, “That’s Microsoft
marketing their products more
aggressively than even Steve Ballmer
was able to!” (&lt;em&gt;Satire!&lt;/em&gt;)&lt;/p&gt;
&lt;/dd&gt;
&lt;dt class=&quot;label&quot; id=&quot;driver-dont-tell-anybody&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id4&quot;&gt;3&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;I have &lt;a class=&quot;reference internal&quot; href=&quot;../about/myself/projects-de.html#projekte-device-driver-for-doze&quot;&gt;&lt;span class=&quot;std std-ref&quot;&gt;written a device driver
for Windows&lt;/span&gt;&lt;/a&gt;, but
please don’t tell anybody.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt class=&quot;label&quot; id=&quot;teamviewer-experience&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id3&quot;&gt;4&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;I have used &lt;a class=&quot;reference external&quot; href=&quot;https://www.teamviewer.com/&quot;&gt;Teamviewer&lt;/a&gt; in the
past, as a part-time teacher at &lt;a class=&quot;reference external&quot; href=&quot;https://www.fh-joanneum.at/&quot;&gt;FH
Joanneum&lt;/a&gt; - it
works great on Linux.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://www.faschingbauer.me/blog/2020/atom.xml">
    <title type="text">Adding a Custom Domain to a Github Pages Project Site</title>
    <id>https://www.faschingbauer.me/blog/2020/03/custom-domain-gh-pages.html</id>
    <updated>2020-03-03T00:00:00Z</updated>
    <published>2020-03-03T00:00:00Z</published>
    <link href="https://www.faschingbauer.me/blog/2020/03/custom-domain-gh-pages.html" />
    <author>
      <name>Jörg Faschingbauer</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;adding-a-custom-domain-to-a-github-pages-project-site&quot;&gt;

&lt;p&gt;In the &lt;a class=&quot;reference internal&quot; href=&quot;2020/03/sphinx-gh-pages.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;previous post&lt;/span&gt;&lt;/a&gt; I pushed
generated static site content to &lt;a class=&quot;reference external&quot; href=&quot;https://pages.github.com/&quot;&gt;Github Pages&lt;/a&gt;, to be served as
&lt;a class=&quot;reference external&quot; href=&quot;https://jfasch.github.io/jfasch-home-pages/&quot;&gt;https://jfasch.github.io/jfasch-home-pages/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Not being a marketing expert (the opposite is the case), I do suspect
that promoting that URL as my homepage would appear unprofessional. Rather,&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;I own a domain, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;To make things easy for people who have the intention of throwing
money at me, I want to have the following URLs point to the above
Github Pages site:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://www.faschingbauer.me&quot;&gt;http://www.faschingbauer.me&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://www.faschingbauer.me&quot;&gt;https://www.faschingbauer.me&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://faschingbauer.me&quot;&gt;http://faschingbauer.me&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://faschingbauer.me&quot;&gt;https://faschingbauer.me&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is remarkably simple nowadays. The Github Pages documentation is
a little confusing: they only talk about user and organization pages,
and &lt;em&gt;not&lt;/em&gt; about project pages. There are &lt;a class=&quot;reference external&quot; href=&quot;https://stackoverflow.com/questions/9082499/custom-domain-for-github-project-pages&quot;&gt;numerous posts&lt;/a&gt;
on the internet that suggest that adding a custom domain to a &lt;em&gt;project
page&lt;/em&gt; has been cumbersome in the past - these days are over,
apparently. Following is what I did.&lt;/p&gt;
&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Contents&lt;/p&gt;
&lt;div class=&quot;contents local topic&quot; id=&quot;contents&quot;&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#configure-a-subdomain-www-faschingbauer-me&quot; id=&quot;id1&quot;&gt;Configure a Subdomain, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#configure-an-apex-domain-faschingbauer-me&quot; id=&quot;id2&quot;&gt;Configure an Apex Domain, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;configure-a-subdomain-www-faschingbauer-me&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id1&quot;&gt;Configure a Subdomain, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;&lt;p&gt;For the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages&lt;/span&gt;&lt;/code&gt; project, configure a custom domain&lt;/p&gt;
&lt;p&gt;(Enforcing HTTPS also makes sense, while we are at it)&lt;/p&gt;
&lt;img alt=&quot;../_images/custom-domain.png&quot; src=&quot;../_images/custom-domain.png&quot; /&gt;
&lt;p&gt;All this does is to create a &lt;code class=&quot;file docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;docs/CNAME&lt;/span&gt;&lt;/code&gt;; pull the changes,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/jfasch-home-pages
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git pull
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Point &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me&lt;/span&gt;&lt;/code&gt; to &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch.github.io&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;At your DNS provider, create a &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;CNAME&lt;/span&gt;&lt;/code&gt; DNS record for
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me&lt;/span&gt;&lt;/code&gt; and set its value to point to
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch.github.io&lt;/span&gt;&lt;/code&gt;. Wait a day before you publish the new site
URL - it may take some time until the changes have propagated to
other name servers. Check like so,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; dig www.faschingbauer.me

&lt;span class=&quot;go&quot;&gt;;www.faschingbauer.me.            IN      A&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;;; ANSWER SECTION:&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;www.faschingbauer.me.     1100    IN      CNAME   jfasch.github.io.&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;jfasch.github.io. 3600    IN      A       185.199.109.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;jfasch.github.io. 3600    IN      A       185.199.111.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;jfasch.github.io. 3600    IN      A       185.199.110.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;jfasch.github.io. 3600    IN      A       185.199.108.153&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;(Output stripped for brevity.) In the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;ANSWER&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;SECTION&lt;/span&gt;&lt;/code&gt; you can
see that &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me.&lt;/span&gt;&lt;/code&gt; (the trailing dot says this is a
FQDN “Fully Qualified Domain Name”) is an alias (&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;CNAME&lt;/span&gt;&lt;/code&gt;) for
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch.github.io.&lt;/span&gt;&lt;/code&gt;. And btw., &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch.github.io.&lt;/span&gt;&lt;/code&gt; has four
addresses (&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;A&lt;/span&gt;&lt;/code&gt;).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Done; surf to &lt;a class=&quot;reference external&quot; href=&quot;https://www.faschingbauer.me&quot;&gt;https://www.faschingbauer.me&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;configure-an-apex-domain-faschingbauer-me&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id2&quot;&gt;Configure an Apex Domain, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We have the subdomain &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;www.faschingbauer.me&lt;/span&gt;&lt;/code&gt; in place, pointing to
our site; now we want &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt; to go to the same
site. Github automatically, magically, apparently, redirects between
apex and subdomains. Consequentially, it is just a matter of DNS
configuration: at the DNS provider, arrange that &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt;
points to one or more of Github’s static IP addresses (taken from the
output of the above &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;dig&lt;/span&gt;&lt;/code&gt; command). These are,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;185.199.108.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;185.199.109.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;185.199.110.153&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;185.199.111.153&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Go to the DNS provider, and arrange that the DNS &lt;em&gt;address&lt;/em&gt; (A) record
for &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;faschingbauer.me&lt;/span&gt;&lt;/code&gt; points to one or all of these addresses.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://www.faschingbauer.me/blog/2020/atom.xml">
    <title type="text">Deploying Sphinx Generated Documentation to Github Pages</title>
    <id>https://www.faschingbauer.me/blog/2020/03/sphinx-gh-pages.html</id>
    <updated>2020-03-02T00:00:00Z</updated>
    <published>2020-03-02T00:00:00Z</published>
    <link href="https://www.faschingbauer.me/blog/2020/03/sphinx-gh-pages.html" />
    <author>
      <name>Jörg Faschingbauer</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;deploying-sphinx-generated-documentation-to-github-pages&quot;&gt;

&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Contents&lt;/p&gt;
&lt;div class=&quot;contents local topic&quot; id=&quot;contents&quot;&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#create-site-publication-repo&quot; id=&quot;id2&quot;&gt;Create “Site Publication Repo”&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#configure-github-pages-for-jfasch-home-pages&quot; id=&quot;id3&quot;&gt;Configure Github Pages for &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#time-for-deployment&quot; id=&quot;id4&quot;&gt;Time for Deployment&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://pages.github.com/&quot;&gt;Github Pages&lt;/a&gt;, a hosting service for
static webpages, is free and easy, although run by Microsoft
&lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#well-theres-marketing&quot; id=&quot;id1&quot;&gt;1&lt;/a&gt;. Times are changing.&lt;/p&gt;
&lt;p&gt;It took me a while to figure out how to use the service properly,
although, retrospectively, it hasn’t been so hard. The main points
were,&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;Github Pages, by default, &lt;em&gt;builds&lt;/em&gt; the stuff you push using &lt;a class=&quot;reference external&quot; href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;. I don’t use Jekyll; rather I generate my
site locally, and want to upload &lt;em&gt;generated content only&lt;/em&gt;. This is
the topic of this post.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The uploaded content is then served as
&lt;a class=&quot;reference external&quot; href=&quot;https://jfasch.github.io/jfasch-home-pages/&quot;&gt;https://jfasch.github.io/jfasch-home-pages/&lt;/a&gt;. Bending things to
serve it as &lt;a class=&quot;reference external&quot; href=&quot;https://www.faschingbauer.me&quot;&gt;https://www.faschingbauer.me&lt;/a&gt; is the topic of a &lt;a class=&quot;reference internal&quot; href=&quot;2020/03/custom-domain-gh-pages.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;companion
post&lt;/span&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;section&quot; id=&quot;create-site-publication-repo&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id2&quot;&gt;Create “Site Publication Repo”&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;admonition important&quot;&gt;
&lt;p class=&quot;admonition-title&quot;&gt;Important&lt;/p&gt;
&lt;p&gt;No, we do &lt;em&gt;not&lt;/em&gt; pollute our &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/jfasch/jfasch-home&quot;&gt;source repo&lt;/a&gt; (I refer to the local
clone as &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home&lt;/span&gt;&lt;/code&gt;) with binary content, as Github
suggests. Rather, we distinguish &lt;em&gt;content&lt;/em&gt; (which is handwritten)
from artifacts that are created during the build.&lt;/p&gt;
&lt;p&gt;This reminds me of a company I worked for many years ago:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;They had a huge pile of incomprehensible C/C++ code.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;They built all that in the source tree (no, not with &lt;a class=&quot;reference external&quot; href=&quot;https://cmake.org/&quot;&gt;CMake&lt;/a&gt;, or &lt;a class=&quot;reference external&quot; href=&quot;https://mesonbuild.com/&quot;&gt;Meson&lt;/a&gt;,
or &lt;a class=&quot;reference external&quot; href=&quot;https://www.gnu.org/software/automake/&quot;&gt;Automake&lt;/a&gt; or
anything else that can do out-of-source builds - but with another
huge pile of incomprehensible Doze &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;cmd&lt;/span&gt;&lt;/code&gt; code.).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;They committed the build output. &lt;strong&gt;Yes&lt;/strong&gt;: every build they made
was a record in their version control system. The same repo that
contained the source.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Effect&lt;/strong&gt;: developers did not develop most of their time, but
wait for VC operations. Rational Clearcase can be blamed for many
things, but not for that.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The company does not exist anymore.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;em&gt;So&lt;/em&gt;, in parallel to the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home&lt;/span&gt;&lt;/code&gt; local copy of &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/jfasch/jfasch-home&quot;&gt;the upstream
Github repo&lt;/a&gt;, I create
another &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/jfasch/jfasch-home-pages&quot;&gt;Github repo&lt;/a&gt;
(cloned locally as &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages&lt;/span&gt;&lt;/code&gt;). The intent is to use the
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages/docs/&lt;/span&gt;&lt;/code&gt; subdirectory as a &lt;em&gt;deployment location&lt;/em&gt;
for the Sphinx-generated output from &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home&lt;/span&gt;&lt;/code&gt; - &lt;em&gt;one
commit/push per deployment&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Test that, by populating &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages&lt;/span&gt;&lt;/code&gt; with dummy HTML
content. Ah, Jekyll: we provide static files which are not source
code, technically, so we do not want Github to build our site with
Jekyll. This is what the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;.nojekyll&lt;/span&gt;&lt;/code&gt; file tells them to - &lt;em&gt;suppress
build&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mkdir docs/
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; cat &amp;lt;&amp;lt;EOF &amp;gt; docs/index.html
&lt;span class=&quot;go&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  &amp;lt;title&amp;gt;Dummy&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;  &amp;lt;p&amp;gt;Hmm. Appears to work.&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;EOF&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; touch docs/.nojekyll
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git add docs/index.html docs/.nojekyll
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git commit -am &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git push
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Maybe check on the Github page that the upstream content matches what
we just created.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;configure-github-pages-for-jfasch-home-pages&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id3&quot;&gt;Configure Github Pages for &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;jfasch-home-pages&lt;/span&gt;&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Go to the upstream deployment repo on Github,
&lt;a class=&quot;reference external&quot; href=&quot;https://github.com/jfasch/jfasch-home-pages&quot;&gt;https://github.com/jfasch/jfasch-home-pages&lt;/a&gt;. Make sure you are
logged in (I made that mistake and did not find the “Settings” tab :-)
). Go to the “Settings” tab.&lt;/p&gt;
&lt;p&gt;We intend to serve content from &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;docs/&lt;/span&gt;&lt;/code&gt; - the &lt;em&gt;Publishing Source&lt;/em&gt; in
Github terminology -, so select “master branch / docs folder”. Scroll
to the “Github Pages” section, and select that constellation.&lt;/p&gt;
&lt;img alt=&quot;../_images/master-docs.png&quot; src=&quot;../_images/master-docs.png&quot; /&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;admonition-title&quot;&gt;Note&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;You will not see the “Your site is published at …” message
immediately; the Github deployment machinery takes a while.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If the message appears, eventually, an innocent click on the link
may lead to a 404 error. Edit the URL in the bar to explicitly
add &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;.../index.html&lt;/span&gt;&lt;/code&gt;, or wait another few minutes for things to
come in order (I do not have to understand why).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;time-for-deployment&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id4&quot;&gt;Time for Deployment&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Everything is in place now,&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;We have a local &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;$HOME/jfasch-home&lt;/span&gt;&lt;/code&gt; (say) clone (and its upstream
repository that we work from)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We have an &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/jfasch/jfasch-home-pages&quot;&gt;upstream&lt;/a&gt;
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;https://github.com/jfasch/jfasch-home-pages&lt;/span&gt;&lt;/code&gt; repository; new
revisions that are pushed are automatically deployed to pages.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We have its local &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;$HOME/jfasch-home-pages&lt;/span&gt;&lt;/code&gt; clone.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lets perform the deployment dance for the first time; this will be
repeated for all further deployments. (This cries for scripting, but
that’s another story.)&lt;/p&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;&lt;p&gt;Build homepage, locally, with Sphinx&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/jfasch-home
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; make html
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(Optional) In the deployment repo, backup the &lt;code class=&quot;file docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;docs/CNAME&lt;/span&gt;&lt;/code&gt;
file&lt;/p&gt;
&lt;p&gt;If you don’t know what this is then you probably haven’t configured
a &lt;em&gt;custom subdomain&lt;/em&gt; for your Github Pages project. See &lt;a class=&quot;reference internal&quot; href=&quot;2020/03/custom-domain-gh-pages.html&quot;&gt;&lt;span class=&quot;doc&quot;&gt;here&lt;/span&gt;&lt;/a&gt; for how that works. This
step can be added as an afterthough so lets omit it for now,
remembering that we have to preserve the &lt;code class=&quot;file docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;docs/CNAME&lt;/span&gt;&lt;/code&gt; file
once we add a custom domain.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/jfasch-home-pages
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; cp docs/CNAME /tmp/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Remove existing site, and copy new site&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/jfasch-home-pages
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git rm -r docs/
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; cp -r &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/jfasch-home/_build/html/ docs/
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; touch docs/.nojekyll
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(Optional) Restore &lt;code class=&quot;file docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;docs/CNAME&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; cp /tmp/CNAME docs/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Deploy (i.e. commit and push)&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git add --all docs/
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git commit -am &lt;span class=&quot;s1&quot;&gt;&amp;#39;shiny new homepage version&amp;#39;&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git push
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Wait a while. You may nervously poll the “Settings” tab of the
upstream deployment repo if you want, until machinery is done.&lt;/p&gt;
&lt;p class=&quot;rubric&quot;&gt;Footnotes&lt;/p&gt;
&lt;dl class=&quot;footnote brackets&quot;&gt;
&lt;dt class=&quot;label&quot; id=&quot;well-theres-marketing&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id1&quot;&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Well ok, if you view &lt;a class=&quot;reference external&quot; href=&quot;https://pages.github.com&quot;&gt;their entry page&lt;/a&gt;, all that
Marketingese sounds familiar.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="https://www.faschingbauer.me/blog/2020/atom.xml">
    <title type="text">Patching and Building the Fedora Kernel</title>
    <id>https://www.faschingbauer.me/blog/2020/02/fedora-kernel-build.html</id>
    <updated>2020-02-27T00:00:00Z</updated>
    <published>2020-02-27T00:00:00Z</published>
    <link href="https://www.faschingbauer.me/blog/2020/02/fedora-kernel-build.html" />
    <author>
      <name>Jörg Faschingbauer</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;patching-and-building-the-fedora-kernel&quot;&gt;

&lt;p&gt;It’s not easy to get up to date information on how to create a custom
kernel on Fedora. There’s plenty of information out there, but most of
it is outdated and only halfway true.&lt;/p&gt;
&lt;p&gt;Here’s what I was able to find out by combining non-outdated
information into a working procedure. It goes as follows.&lt;/p&gt;
&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Contents&lt;/p&gt;
&lt;div class=&quot;contents local topic&quot; id=&quot;contents&quot;&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#why&quot; id=&quot;id5&quot;&gt;Why?&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#find-kernel-source-git-fix-it-and-create-patch&quot; id=&quot;id6&quot;&gt;Find Kernel Source (Git), Fix It, and Create Patch&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#prepare-the-rpm-build&quot; id=&quot;id7&quot;&gt;Prepare the RPM Build&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#download-and-install-source-rpm-for-crashing-kernel&quot; id=&quot;id8&quot;&gt;Download and Install Source RPM For Crashing Kernel&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#apply-the-patch&quot; id=&quot;id9&quot;&gt;Apply the Patch&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#build-the-kernel-rpms&quot; id=&quot;id10&quot;&gt;Build the Kernel RPMs&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#install-kernel&quot; id=&quot;id11&quot;&gt;Install Kernel&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;why&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id5&quot;&gt;Why?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Tracking down a bug on my new USB-C/Thunderbolt-only laptop where an
external HDMI monitor is plugged via an adapter.&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;Plug external monitor&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unplug external monitor&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Wait a few seconds&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Watch kernel go up in flames&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id3&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;The Oops&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: BUG: kernel NULL pointer dereference, address: 0000000000000080&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: #PF: supervisor read access in kernel mode&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: #PF: error_code(0x0000) - not-present page&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: PGD 0 P4D 0&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Oops: 0000 [#1] SMP PTI&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CPU: 0 PID: 281 Comm: kworker/0:2 Not tainted 5.4.13-201.fc31.x86_64 #1&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Hardware name: ASUSTeK COMPUTER INC. ZenBook S UX391UA/UX391UA, BIOS UX391UA.204 05/18/2018&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Workqueue: events ucsi_connector_change [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RIP: 0010:ucsi_displayport_remove_partner+0xa/0x20 [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Code: 38 00 c7 43 28 00 00 00 00 48 83 c7 10 5b e9 6d f3 3d fb 66 66 2e 0f 1f 84 00 00 00 00 00 66 90 0f 1f 44 00 00 48 85 ff 74 0f &amp;lt;48&amp;gt; 8b 47 78 48 c7 00 00 00 00 00 c6 40 3d 00 c3 66 0f 1f 44 00 00&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RSP: 0018:ffff9daa002d3df8 EFLAGS: 00010202&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RAX: 0000000000000008 RBX: ffff901f4ce35710 RCX: 0000000000003c7d&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RDX: 0000000000003c7c RSI: 0000000000000001 RDI: 0000000000000008&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RBP: 0000000000000000 R08: ffffffffbc7dbe60 R09: ffff9daa002d3cf0&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: R10: ffff901f54951a18 R11: ffff901f56a68a78 R12: ffff901f4ce35710&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: R13: 0000000000000001 R14: ffff901f4ce35860 R15: ffff901f4ce355d8&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: FS:  0000000000000000(0000) GS:ffff901f56a00000(0000) knlGS:0000000000000000&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CR2: 0000000000000080 CR3: 000000028fbbc003 CR4: 00000000003606f0&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Call Trace:&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ucsi_unregister_altmodes+0x77/0x90 [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ucsi_unregister_partner.part.0+0x13/0x30 [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ucsi_connector_change+0x247/0x340 [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  process_one_work+0x1b5/0x360&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  worker_thread+0x50/0x3c0&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  kthread+0xf9/0x130&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ? process_one_work+0x360/0x360&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ? kthread_park+0x90/0x90&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  ret_from_fork+0x35/0x40&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Modules linked in: cdc_ether usbnet r8152 mii rc_cec typec_displayport thunderbolt uinput rfcomm ccm xt_CHECKSUM xt_MASQUERADE nf_nat_tftp nf_conntrack_tftp tun bridge stp llc nf_conntrack_netbios_ns nf_conntrack_broadcast xt_CT ip6t_REJECT nf_reject_ipv6 ip6t_rpfilter ipt_REJECT nf_reject_ipv4 xt_conntrack ebtable_nat ebtable_broute ip6table_nat ip6table_mangle ip6table_raw ip6table_security iptable_nat nf_nat iptable_mangle iptable_raw iptable_security nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c ip_set nfnetlink ebtable_filter ebtables ip6table_filter ip6_tables iptable_filter cmac bnep sunrpc vfat fat snd_hda_codec_hdmi snd_soc_skl snd_soc_sst_ipc snd_soc_sst_dsp snd_hda_ext_core x86_pkg_temp_thermal intel_powerclamp snd_soc_acpi_intel_match coretemp snd_soc_acpi kvm_intel snd_soc_core snd_hda_codec_realtek snd_hda_codec_generic snd_compress ledtrig_audio ac97_bus kvm snd_pcm_dmaengine iwlmvm snd_hda_intel snd_intel_dspcfg irqbypass snd_hda_codec uvcvideo mac80211&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel:  btusb iTCO_wdt btrtl crct10dif_pclmul videobuf2_vmalloc iTCO_vendor_support videobuf2_memops mei_hdcp btbcm btintel crc32_pclmul intel_rapl_msr snd_hda_core videobuf2_v4l2 libarc4 ghash_clmulni_intel videobuf2_common snd_hwdep intel_cstate bluetooth snd_seq asus_nb_wmi iwlwifi videodev snd_seq_device intel_uncore asus_wmi snd_pcm intel_rapl_perf mc cdc_acm sparse_keymap wmi_bmof ecdh_generic cfg80211 intel_wmi_thunderbolt ecc pcspkr snd_timer snd i2c_i801 soundcore joydev idma64 intel_xhci_usb_role_switch mei_me ucsi_acpi processor_thermal_device typec_ucsi intel_rapl_common mei roles intel_soc_dts_iosf intel_pch_thermal typec int3403_thermal int340x_thermal_zone int3400_thermal acpi_thermal_rel acpi_pad binfmt_misc ip_tables rfkill i915 i2c_algo_bit drm_kms_helper hid_multitouch drm nvme crc32c_intel nvme_core serio_raw wmi i2c_hid video fuse&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CR2: 0000000000000080&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: ---[ end trace 76d248e576fee192 ]---&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RIP: 0010:ucsi_displayport_remove_partner+0xa/0x20 [typec_ucsi]&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: Code: 38 00 c7 43 28 00 00 00 00 48 83 c7 10 5b e9 6d f3 3d fb 66 66 2e 0f 1f 84 00 00 00 00 00 66 90 0f 1f 44 00 00 48 85 ff 74 0f &amp;lt;48&amp;gt; 8b 47 78 48 c7 00 00 00 00 00 c6 40 3d 00 c3 66 0f 1f 44 00 00&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RSP: 0018:ffff9daa002d3df8 EFLAGS: 00010202&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RAX: 0000000000000008 RBX: ffff901f4ce35710 RCX: 0000000000003c7d&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RDX: 0000000000003c7c RSI: 0000000000000001 RDI: 0000000000000008&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RBP: 0000000000000000 R08: ffffffffbc7dbe60 R09: ffff9daa002d3cf0&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: R10: ffff901f54951a18 R11: ffff901f56a68a78 R12: ffff901f4ce35710&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: R13: 0000000000000001 R14: ffff901f4ce35860 R15: ffff901f4ce355d8&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: FS:  0000000000000000(0000) GS:ffff901f56a00000(0000) knlGS:0000000000000000&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: CR2: 0000000000000080 CR3: 000000028fbbc003 CR4: 00000000003606f0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Looking at the cause, we see that the crash is a NULL pointer that is
deferenced in &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;ucsi_displayport_remove_partner()&lt;/span&gt;&lt;/code&gt;,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: BUG: kernel NULL pointer dereference, address: 0000000000000080&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;... (blah) ...&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Feb 26 13:58:08 zen kernel: RIP: 0010:ucsi_displayport_remove_partner+0xa/0x20 [typec_ucsi]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;A look at the offending source code shows that the fix must be
easy. The only pointer that is being accessed is &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;dp&lt;/span&gt;&lt;/code&gt;, and that
pointer is not checked for NULL-ness.&lt;/p&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id4&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;drivers/usb/typec/ucsi/displayport.c (taken from Linus
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;master&lt;/span&gt;&lt;/code&gt;)&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-c notranslate&quot;&gt;&lt;table class=&quot;highlighttable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;linenos&quot;&gt;&lt;div class=&quot;linenodiv&quot;&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ucsi_displayport_remove_partner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typec_altmode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ucsi_dp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
             &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;hll&quot;&gt;     &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;typec_altmode_get_drvdata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;hll&quot;&gt;     &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The fix is really easy,&lt;/p&gt;
&lt;div class=&quot;highlight-udiff notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- /home/jfasch/work/jfasch-home/blog/2020/02/displayport.c.orig&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ /home/jfasch/work/jfasch-home/blog/2020/02/displayport.c&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -271,6 +271,8 @@&lt;/span&gt;
 		return;
 
 	dp = typec_altmode_get_drvdata(alt);
&lt;span class=&quot;gi&quot;&gt;+    if (!dp)&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+		return;&lt;/span&gt;
 	dp-&amp;gt;data.conf = 0;
 	dp-&amp;gt;data.status = 0;
 	dp-&amp;gt;initialized = false;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The bug is tracked as &lt;a class=&quot;reference external&quot; href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1785972&quot;&gt;Red Hat Bugzilla – Bug 1785972&lt;/a&gt;, and upstream
is already involved. John Stebbins and I provided testing, but
roundtrips are rather long. What makes things worse is that there
appear to be multiple issues, not just one.&lt;/p&gt;
&lt;p&gt;I’ll focus on mine: patch, build, report, and help with
testing. First, see how kernels are built in Fedora.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;find-kernel-source-git-fix-it-and-create-patch&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id6&quot;&gt;Find Kernel Source (Git), Fix It, and Create Patch&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Link&lt;/p&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://fedoraproject.org/wiki/Building_a_custom_kernel#Building_a_kernel_from_the_exploded_git_trees&quot;&gt;Fedora Wiki: “Exploded Git Trees”&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Fedora has a Git repository at &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;kernel.org&lt;/span&gt;&lt;/code&gt; where they apply their
own patches on top of the vanilla kernel. Clone that, and create a
development branch. (I am on Fedora 31, so I’m basing the branch on
that.)&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git clone git://git.kernel.org/pub/scm/linux/kernel/git/jwboyer/fedora.git
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git checkout -b jfasch-fix remotes/origin/f31
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Fix &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;drivers/usb/typec/ucsi/displayport.c&lt;/span&gt;&lt;/code&gt; as sketched above, and
commit.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git commit -am &lt;span class=&quot;s1&quot;&gt;&amp;#39;fix RIP:ucsi_displayport_remove_partner()&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The remainder of the procedure will build the kernel RPM. A kernel RPM
build works by applying a set of patches on top of the base vanilla
kernel &lt;a class=&quot;footnote-reference brackets&quot; href=&quot;#exploded-tree&quot; id=&quot;id1&quot;&gt;1&lt;/a&gt;, so we create a patch for later use.&lt;/p&gt;
&lt;p&gt;I made only one commit for which I want to create a patch. Find out
the revision that this patch is based upon; it is one revision before
the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;HEAD&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git show --quiet HEAD~1
&lt;span class=&quot;go&quot;&gt;commit 4382f76bc8ef9fce5e7e96d4cdb0c073564ad249 (tag: kernel-5.5.6-201.fc31, origin/f31)&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Author: Josh Boyer &amp;lt;jwboyer@fedoraproject.org&amp;gt;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Date:   Mon Feb 24 23:09:20 2020 +0000&lt;/span&gt;

&lt;span class=&quot;go&quot;&gt;    kernel-5.5.6-201.fc31 configs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Create the patch which we will pick up later,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; git format-patch -o /tmp 4382f76bc8ef9fce5e7e96d4cdb0c073564ad249
&lt;span class=&quot;go&quot;&gt;/tmp/0001-fix-RIP-ucsi_displayport_remove_partner.patch&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;prepare-the-rpm-build&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id7&quot;&gt;Prepare the RPM Build&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;sidebar&quot;&gt;
&lt;p class=&quot;sidebar-title&quot;&gt;Link&lt;/p&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://fedoraproject.org/wiki/Building_a_custom_kernel/Source_RPM#Prepare_Build_Files&quot;&gt;Building a custom kernel/Source RPM&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;contents local topic&quot; id=&quot;id2&quot;&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#install-prerequisites&quot; id=&quot;id12&quot;&gt;Install Prerequisites&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class=&quot;reference internal&quot; href=&quot;#setup-rpmbuild-directory&quot; id=&quot;id13&quot;&gt;Setup &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;rpmbuild&lt;/span&gt;&lt;/code&gt; Directory&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;install-prerequisites&quot;&gt;
&lt;h3&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id12&quot;&gt;Install Prerequisites&lt;/a&gt;&lt;/h3&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; sudo dnf install rpmdevtools koji
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;setup-rpmbuild-directory&quot;&gt;
&lt;h3&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id13&quot;&gt;Setup &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;rpmbuild&lt;/span&gt;&lt;/code&gt; Directory&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Setup an empty RPM tree. This will simply create a directory
&lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;rpmbuild&lt;/span&gt;&lt;/code&gt; skeleton tree in the home directory.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rpmdev-setuptree
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; tree ~/rpmbuild/
&lt;span class=&quot;go&quot;&gt;/home/jfasch/rpmbuild/&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── BUILD&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── RPMS&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── SOURCES&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── SPECS&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;└── SRPMS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;download-and-install-source-rpm-for-crashing-kernel&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id8&quot;&gt;Download and Install Source RPM For Crashing Kernel&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Find out the version of the crashing kernel (the one that is currently
running),&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; uname -r
&lt;span class=&quot;go&quot;&gt;5.4.13-201.local.fc31.x86_64&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Download the corresponding source RPM from their build engine,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; koji download-build --arch&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;src kernel-5.4.13-201.fc31
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; ls -l *.rpm
&lt;span class=&quot;go&quot;&gt;kernel-5.4.13-201.fc31.src.rpm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Install the RPM. This will fill the &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;~/rpmbuild/&lt;/span&gt;&lt;/code&gt; skeleton with the
kenrel build instructions.&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rpm -ivh kernel-5.4.13-201.fc31.src.rpm
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; tree ~/rpmbuild/
&lt;span class=&quot;go&quot;&gt;/home/jfasch/rpmbuild/&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── BUILD&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── RPMS&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── SOURCES&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;│   ├── 0001-crypto-ccp-Release-all-allocated-memory-if-sha-type-.patch&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;│   ├── 0001-Drop-that-for-now.patch&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;... (blah) ...&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;├── SPECS&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;│   └── kernel.spec&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;└── SRPMS&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;apply-the-patch&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id9&quot;&gt;Apply the Patch&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Copy the patch from above into the build tree, where the other patches
are,&lt;/p&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; cp /tmp/0001-fix-RIP-ucsi_displayport_remove_partner.patch &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    ~/rpmbuild/SOURCES/RIP-ucsi_displayport_remove_partner.patch
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Edit the build specification, &lt;code class=&quot;docutils literal notranslate&quot;&gt;&lt;span class=&quot;pre&quot;&gt;~/rpmbuild/SPECS/kernel.spec&lt;/span&gt;&lt;/code&gt;, to&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;contain a descriptive version&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;apply the patch&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlight-udiff notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gd&quot;&gt;--- /home/jfasch/work/jfasch-home/blog/2020/02/kernel.spec.orig&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+++ /home/jfasch/work/jfasch-home/blog/2020/02/kernel.spec&lt;/span&gt;
&lt;span class=&quot;gu&quot;&gt;@@ -53,7 +53,7 @@&lt;/span&gt;
 %global zipsed -e &amp;#39;s/\.ko$/\.ko.xz/&amp;#39;
 %endif
 
&lt;span class=&quot;gd&quot;&gt;-# define buildid .local&lt;/span&gt;
&lt;span class=&quot;gi&quot;&gt;+%define buildid .jfasch&lt;/span&gt;
 
 %if 0%{?fedora}
 %define primary_target fedora
&lt;span class=&quot;gu&quot;&gt;@@ -825,6 +825,7 @@&lt;/span&gt;
 
 # ALSA code from v5.6 (Intel ASoC Sound Open Firmware driver support)
 Patch601: alsa-5.6.patch
&lt;span class=&quot;gi&quot;&gt;+Patch999: RIP-ucsi_displayport_remove_partner.patch&lt;/span&gt;
 
 # END OF PATCH DEFINITIONS
 
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;build-the-kernel-rpms&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id10&quot;&gt;Build the Kernel RPMs&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/rpmbuild/SPECS/
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rpmbuild -bb --target&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x86_64 kernel.spec
&lt;span class=&quot;go&quot;&gt;... roedel ...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Before doing this, make sure the following is available:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;p&gt;Enough RAM&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Enough disk&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Patience, coffee, or something else to do&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;install-kernel&quot;&gt;
&lt;h2&gt;&lt;a class=&quot;toc-backref&quot; href=&quot;#id11&quot;&gt;Install Kernel&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;highlight-console notranslate&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; sudo rpm -ivh --oldpackage &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   ~/rpmbuild/RPMS/x86_64/kernel-core-5.4.13-201.jfasch.fc31.x86_64.rpm &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   ~/rpmbuild/RPMS/x86_64/kernel-modules-5.4.13-201.jfasch.fc31.x86_64.rpm
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;admonition-title&quot;&gt;Note&lt;/p&gt;
&lt;p&gt;The kernel is not signed, obviously, so you might have to disable
Secure Boot in your UEFI.&lt;/p&gt;
&lt;/div&gt;
&lt;p class=&quot;rubric&quot;&gt;Footnotes&lt;/p&gt;
&lt;dl class=&quot;footnote brackets&quot;&gt;
&lt;dt class=&quot;label&quot; id=&quot;exploded-tree&quot;&gt;&lt;span class=&quot;brackets&quot;&gt;&lt;a class=&quot;fn-backref&quot; href=&quot;#id1&quot;&gt;1&lt;/a&gt;&lt;/span&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Yes, the patches are created from the Git
repository we are working with.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
</feed>
